{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/render/utils/Vec3.ts","webpack:///./src/render/utils/Ray.ts","webpack:///./src/render/index.ts","webpack:///./src/worker.js","webpack:///./src/render/utils/Sphere.ts","webpack:///./src/render/utils/HitRecord.ts","webpack:///./src/render/utils/HitableList.ts","webpack:///./src/render/utils/Camera.ts","webpack:///./src/render/progress.ts"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","Vec3","e0","e1","e2","this","add","v1","v2","sub","mul","div","dot","cross","squaredLength","Math","pow","length","sqrt","v","unitVec","Ray","origin","direction","getPoint","Sphere_1","HitableList_1","Camera_1","Vec3_1","Ray_1","progress_1","default","image","width","height","y","x","index","_a","Array","_x","_y","transform","_b","color","world","hitRecord","hit","Infinity","target","normal","random","randomInUnitSphere","unitDirection","camera","getRay","g","b","a","method","args","ball","earth","worker","render","onmessage","e","data","msg","postMessage","HitRecord_1","Sphere","center","radius","ray","t_min","t_max","oc","discriminate","temp","HitRecord","HitableList","hitablelist","list","closestHit","record","map","forEach","Camera","leftBottom","horizontal","vertical","status"],"mappings":"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","file":"worker.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/dist/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 7);\n","export default class Vec3 {\r\n\r\n    e0: number = 0\r\n    e1: number = 0\r\n    e2: number = 0\r\n\r\n\r\n    constructor(e0 = 0, e1 = 0, e2 = 0) {\r\n        this.e0 = e0\r\n        this.e1 = e1\r\n        this.e2 = e2\r\n    }\r\n\r\n\r\n    static add(v1: number | Vec3, v2: number | Vec3): Vec3 {\r\n        return (\r\n            typeof v1 === 'number'\r\n                ? Vec3.add(new Vec3(v1, v1, v1), v2)\r\n                : typeof v2 === 'number'\r\n                    ? Vec3.add(v1, new Vec3(v2, v2, v2))\r\n                    : new Vec3(v1.e0 + v2.e0, v1.e1 + v2.e1, v1.e2 + v2.e2)\r\n        )\r\n    }\r\n\r\n    static sub(v1: number | Vec3, v2: number | Vec3): Vec3 {\r\n        return (\r\n            typeof v1 === 'number'\r\n                ? Vec3.sub(new Vec3(v1, v1, v1), v2)\r\n                : typeof v2 === 'number'\r\n                    ? Vec3.sub(v1, new Vec3(v2, v2, v2))\r\n                    : new Vec3(v1.e0 - v2.e0, v1.e1 - v2.e1, v1.e2 - v2.e2)\r\n        )\r\n    }\r\n\r\n    static mul(v1: number | Vec3, v2: number | Vec3): Vec3 {\r\n        return (\r\n            typeof v1 === 'number'\r\n                ? Vec3.mul(new Vec3(v1, v1, v1), v2)\r\n                : typeof v2 === 'number'\r\n                    ? Vec3.mul(v1, new Vec3(v2, v2, v2))\r\n                    : new Vec3(v1.e0 * v2.e0, v1.e1 * v2.e1, v1.e2 * v2.e2)\r\n        )\r\n    }\r\n\r\n    static div(v1: number | Vec3, v2: number | Vec3): Vec3 {\r\n\r\n        return (\r\n            typeof v1 === 'number'\r\n                ? Vec3.div(new Vec3(v1, v1, v1), v2)\r\n                : typeof v2 === 'number'\r\n                    ? Vec3.div(v1, new Vec3(v2, v2, v2))\r\n                    : new Vec3(v1.e0 / v2.e0, v1.e1 / v2.e1, v1.e2 / v2.e2)\r\n        )\r\n    }\r\n\r\n    static dot(v1: Vec3, v2: Vec3) {\r\n        return v1.e0 * v2.e0 + v1.e1 * v2.e1 + v1.e2 * v2.e2\r\n    }\r\n\r\n    static cross(v1: Vec3, v2: Vec3) {\r\n        return new Vec3(\r\n            (v1.e1 * v2.e2 - v1.e2 * v2.e1),\r\n            (v1.e0 * v2.e2 - v1.e2 * v2.e0) * (-1),\r\n            (v1.e0 * v2.e1 - v1.e1 * v2.e0)\r\n        )\r\n    }\r\n\r\n    // 向量长度\r\n    squaredLength() {\r\n        return this.e0 ** 2 + this.e1 ** 2 + this.e2 ** 2\r\n    }\r\n    length() {\r\n        return Math.sqrt(this.squaredLength())\r\n    }\r\n\r\n    // 向量加减乘除\r\n    add(v: Vec3|number) {\r\n        return Vec3.add(this, v)\r\n    }\r\n\r\n    sub(v: Vec3|number) {\r\n        return Vec3.sub(this, v)\r\n    }\r\n\r\n    mul(v: Vec3|number) {\r\n\r\n        return Vec3.mul(this, v)\r\n    }\r\n\r\n    div(v: Vec3|number) {\r\n        return Vec3.div(this, v)\r\n    }\r\n\r\n    //单位向量(向量方向)\r\n    unitVec() {\r\n        return this.div(this.length())\r\n    }\r\n\r\n\r\n}","import Vec3 from './Vec3'\r\n\r\nexport default class Ray {\r\n    origin: Vec3\r\n    direction: Vec3\r\n    constructor(origin: Vec3, direction: Vec3) {\r\n        this.origin = origin\r\n        this.direction = direction\r\n    }\r\n\r\n    getPoint(t: number) {\r\n        return this.direction.mul(t)\r\n    }\r\n}","\r\nimport Sphere from './utils/Sphere'\r\nimport hitable from './utils/hitable.interface'\r\nimport HitableList from \"./utils/HitableList\";\r\nimport Camera from \"./utils/Camera\";\r\nimport Vec3 from \"./utils/Vec3\"\r\nimport Ray from \"./utils/Ray\"\r\n\r\n\r\nimport progress from './progress'\r\n\r\nexport default function (image: Uint8ClampedArray, width: number, height: number): {\r\n    method: string,\r\n    args: Uint8ClampedArray[]\r\n} {\r\n    progress('start')\r\n\r\n    for (let y = 0; y < height; y++) {\r\n\r\n        for (let x = 0; x < width; x++) {\r\n\r\n            let index = y * width * 4 + x * 4\r\n            const n = 100\r\n\r\n            let [r, g, b, a] = new Array(n)\r\n                .fill(0)\r\n                .map(v => sampling((x + Math.random()) / width, (y + Math.random()) / height))\r\n                .reduce((res, v) => {\r\n                    res[0] += v[0]\r\n                    res[1] += v[1]\r\n                    res[2] += v[2]\r\n                    res[3] += v[3]\r\n                    return res\r\n                }, [0, 0, 0, 0])\r\n                .map(v => v / n)\r\n\r\n            image[index] = r * 255\r\n            image[index + 1] = g * 255\r\n            image[index + 2] = b * 255\r\n            image[index + 3] = a * 255\r\n        }\r\n\r\n        progress(y / height)\r\n    }\r\n\r\n    progress('complete')\r\n\r\n    return {\r\n        method: 'render',\r\n        args: [image]\r\n    }\r\n}\r\n\r\n\r\n// input   x [0..1] y [1..0]\r\n// output  x [0..1] y [0..1]\r\nfunction transform(x: number, y: number) {\r\n    return [x, 1 - y]\r\n}\r\n\r\nfunction sampling(_x: number, _y: number) {\r\n    const [x, y] = transform(_x, _y)\r\n\r\n    const origin = new Vec3(0, 0, 0)\r\n    const vertical = new Vec3(0, 2, 0)\r\n    const horizontal = new Vec3(4, 0, 0)\r\n    const leftBottom = new Vec3(-2, -1, -1)\r\n\r\n    const ray = camera.getRay(x, y)\r\n\r\n    const { e0, e1, e2 } = color(ray,world)\r\n\r\n    return [e0, e1, e2, 1]\r\n\r\n}\r\n\r\n\r\nconst ball = new Sphere(new Vec3(0, 0, -1), 0.5)\r\nconst earth = new Sphere(new Vec3(0, -100.5, -1), 100)\r\nconst world = new HitableList([ball, earth])\r\n\r\nconst camera = new Camera(new Vec3(0, 0, 0), new Vec3(-2, -1, -1), new Vec3(4, 0, 0), new Vec3(0, 2, 0))\r\n\r\nfunction randomInUnitSphere() {\r\n    let p: Vec3\r\n    do {\r\n        p = new Vec3(Math.random(), Math.random(), Math.random()).mul(2.0).sub(new Vec3(1, 1, 1))\r\n    } while (p.squaredLength() >= 1)\r\n\r\n    return p\r\n}\r\n\r\n\r\nfunction color(r: Ray, world: hitable): Vec3 {\r\n    const hitRecord = world.hit(r, 0, Infinity)\r\n\r\n    if (hitRecord) {\r\n        const target = hitRecord.p.add(hitRecord.normal).add(randomInUnitSphere())\r\n        return color(new Ray(hitRecord.p, target.sub(hitRecord.p)),world).mul(0.5)\r\n        // return hitRecord.normal.add(1).mul(0.5)\r\n    }\r\n\r\n\r\n    // 设置背景色\r\n    const\r\n        unitDirection = r.direction.unitVec(),\r\n        t = (unitDirection.e1 + 1.0) * 0.5\r\n\r\n    return new Vec3(1,1,1)\r\n    // return Vec3.add(new Vec3(1, 1, 1).mul((1 - t)), new Vec3(0.5, 0.7, 1).mul(t))\r\n}\r\n\r\n","import render from './render'\r\n\r\nconst worker = { render }\r\n\r\nonmessage = function(e) {\r\n    const { method, args = [] } = e.data\r\n\r\n    if (worker[method]) {\r\n        const msg = worker[method](...args)\r\n        if (msg) {\r\n            postMessage(msg)\r\n        }\r\n    } else\r\n        postMessage({\r\n            method: 'warning',\r\n            args: [`worker: can't find method (${method})`]\r\n        })\r\n}","import HitRecord from \"./HitRecord\";\r\nimport hitable from './hitable.interface'\r\nimport Ray from \"./Ray\";\r\nimport Vec3 from \"./Vec3\";\r\n\r\nexport default class Sphere implements hitable {\r\n\r\n    center: Vec3\r\n    radius: number\r\n\r\n    constructor(center: Vec3, r: number) {\r\n        this.center = center\r\n        this.radius = r\r\n    }\r\n\r\n    hit(ray: Ray, t_min: number, t_max: number) {\r\n\r\n        const hit = new HitRecord()\r\n        const oc = Vec3.sub(ray.origin, this.center)\r\n        const a = Vec3.dot(ray.direction, ray.direction)\r\n        const b = Vec3.dot(oc, ray.direction) * 2\r\n        const c = Vec3.dot(oc, oc) - this.radius ** 2\r\n        const discriminate = b ** 2 - 4 * a * c\r\n\r\n        if (discriminate > 0) {\r\n            let temp\r\n            temp = (-b - Math.sqrt(discriminate)) / (2 * a)\r\n            if (temp > t_min && temp < t_max) {\r\n                hit.t = temp\r\n                hit.p = ray.getPoint(temp)\r\n                hit.normal = hit.p.sub(this.center).div(this.radius)\r\n                return hit\r\n            }\r\n            temp = (-b + Math.sqrt(discriminate)) / (2 * a)\r\n            if (temp > t_min && temp < t_max) {\r\n                hit.t = temp\r\n                hit.p = ray.getPoint(temp)\r\n                hit.normal = hit.p.sub(this.center).div(this.radius)\r\n                return hit\r\n            }\r\n        }\r\n\r\n        return null\r\n    }\r\n}","import Vec3 from \"./Vec3\";\r\n\r\nexport default class HitRecord {\r\n    t: number\r\n    p: Vec3\r\n    normal: Vec3\r\n    constructor(\r\n        t: number = 0,\r\n        p: Vec3 = new Vec3(0, 0, 0),\r\n        normal: Vec3 = new Vec3(0, 0, 0)) {\r\n            \r\n        this.t = t\r\n        this.p = p\r\n        this.normal = normal\r\n    }\r\n}","import HitRecord from './HitRecord'\r\nimport Ray from './Ray';\r\nimport hitable from './hitable.interface';\r\n\r\nexport default class HitableList implements hitable {\r\n\r\n    list: hitable[] = []\r\n\r\n    constructor(hitablelist: hitable[]) {\r\n        this.list = hitablelist\r\n    }\r\n\r\n    hit(ray: Ray, t_min: number, t_max: number) {\r\n        let isHitted = false,\r\n            closestHit = t_max,\r\n            record:HitRecord = null\r\n\r\n        this.list\r\n            .map(v => v.hit(ray, t_min, t_max))\r\n            .forEach(v => {\r\n                if (v && v.t < closestHit) {\r\n                    record = v\r\n                    closestHit = v.t\r\n                }\r\n            })\r\n\r\n        return record\r\n    }\r\n}","import Vec3 from './Vec3'\r\nimport Ray from './Ray';\r\n\r\nexport default class Camera {\r\n\r\n    origin = new Vec3(0, 0, 0)\r\n    vertical = new Vec3(0, 2, 0)\r\n    horizontal = new Vec3(4, 0, 0)\r\n    leftBottom = new Vec3(-2, -1, -1)\r\n\r\n    constructor(origin:Vec3,leftBottom:Vec3,horizontal:Vec3,vertical:Vec3) {\r\n        this.origin = origin\r\n        this.vertical = vertical\r\n        this.leftBottom = leftBottom\r\n        this.horizontal = horizontal\r\n    }\r\n\r\n    getRay(x: number, y: number): Ray {\r\n        return new Ray(this.origin, this.leftBottom.add(this.horizontal.mul(x)).add(this.vertical.mul(y)).sub(this.origin))\r\n    }\r\n}","export default function (status: 'start' | 'complete' | 'error' | 'working' | number) {\r\n\r\n    (<any>postMessage)({\r\n        method: 'reportProgress',\r\n        args: typeof status == 'number' ? ['working', status] : [status]\r\n    });\r\n    \r\n}"],"sourceRoot":""}